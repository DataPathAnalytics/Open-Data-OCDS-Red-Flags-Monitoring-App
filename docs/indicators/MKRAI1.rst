##############################################################################################
MKRAI1. В закупке принимают участие поставщики (подрядчики) с одинаковыми контактными данными.
##############################################################################################

***************
Суть индикатора
***************

Индикатор исследует случаи, когда участники конкурса подают одинаковые контактные данные: номера телефонов, адреса электронной почты.

****
Риск
****
Сговор участников. 

*******************************
Нарушение норм/принципов закона
*******************************

Нарушение принципов проведения закупок, описанных в статье 1 Закона КР "О государственных закупках".

***********************************
Основание для разработки индикатора
***********************************

Индикатор разработан, так как в системе не реализован контроль за совпадением контактных данных поставщиков.

*******************************
Методология расчета индикатора.
*******************************

Уровень расчета
===============
Индикатор расcчитывается на уровне *конкурса*.

Источники данных для расчета
============================

Для расчета индикатора используются следующие источники данных:

- API системы государственных закупок в OCDS формате

Методы закупок
==============

Индикатор рассчитывается для следующих типов конкурсов:

- одноэтапный конкурс;
- двухэтапный конкурс;
- упрощенный конкурс;
- конкурс на понижение цены.


Статусы конкурсов
-----------------

Индикатор расчитывается для процедур, которые:

- находятся в статусе ``bidsOpened``
- находятся в статусе ``evaluationResultsPending``

Качество данных
---------------

Индикатор расчитывается только для конкурсов, у которых значение переменной ``tv_badQuality=0``.


Частота расчета
===============

Если выполнены все условия для активации расчета индикатора, он рассчитывается каждый раз после изменений в JSON-документе конкурса. Также индикатор расчитывается один раз в сутки, если выполнены все условия для его расчета.

Поля для расчета
================

Для расчета индикатора используются следующие поля API модуля системы гос. закупок:

- ``data.parties.id``
- ``data.bids.details.tenderers.id``
- ``data.bids.details.status``
- ``data.bids.details.relatedLots.id``
- ``data.tender.lots.id``
- ``data.tender.lots.status``
- ``data.parties.id``
- ``data.parties.additionalContactPoints.email``
- ``data.parties.additionalContactPoints.telephone``


Формула расчета
===============

1. Выбираем все лоты из конкурса, у которых ``data.tender.lots.status='active'``.

2. Для каждого такого лота делаем следующее.

2.1. Выбираем предложения участников на лот: ``data.tender.lots.id`` входит в массив ``data.bids.details.relatedLots.id``. Из найденных берем только те предложения, у которых ``data.bids.details.status='active'``. 

2.2. Из найденных предложений выбираем идентификаторы участников - ``data.bids.details.tenderers.id``.

2.3. По идентификаторам находим карточки участников ``data.parties``, у которых ``data.parties.id=data.bids.details.tenderers.id``.

2.4. Из каждой карточки выбираем массивы номеров телефонов и почтовых адресов: ``data.parties.additionalContactPoints.email`` и ``data.parties.additionalContactPoints.telephone``.

2.5. Попарно сравниваем адреса и телефоны разных участников между собой (не нужно попарно сравнивать телефоны и адреса внутри одной карточки).

2.6. Если находим совпадающие, индикатор принимает значение ``1``, если совпадений не найдено - ``0``

Факторы, которые влияют на корректное срабатывание индикатора
=============================================================

Индикатор может срабатывать неправильнов случае, когда один участник подает несколько предложений на один и тот же лот.
