###########################################################################################
MKRAI8. На конкурс (лот) закупающей организации 20-й и более раз приходит всего 1 участник.
###########################################################################################

***************
Суть индикатора
***************

Индикатор исследует случаи, когда на конкурсы к закупающей организации часто приходит всего 1 участник.

****
Риск
****
Сговор представителей закупающей организации и поставщика. 

*******************************
Нарушение норм/принципов закона
*******************************

Возможное нарушение статьи 27, пункта 4 Закона КР "О государственных закупках"

***********************************
Основание для разработки индикатора
***********************************

*******************************
Методология расчета индикатора.
*******************************

Уровень расчета
===============
Индикатор расcчитывается на уровне *конкурса*.

Источники данных для расчета
============================

Для расчета индикатора используются следующие источники данных:

- API системы государственных закупок в OCDS формате
- Аналитическая таблица :ref:`tbl_oneBidderInTender`

Типы конкурсов
==============

Индикатор рассчитывается для следующих типов конкурсов:

- одноэтапный конкурс;
- двухэтапный конкурс.


Статусы конкурсов
-----------------

Индикатор расчитывается для процедур, которые:

- находятся в статусе ``bidsOpened``
- находятся в статусе ``evaluationResultsPending``


Качество данных
---------------

Индикатор расчитывается только для конкурсов, у которых значение переменной ``tv_badQuality=0``.



Частота расчета
===============

Если выполнены все условия для активации расчета индикатора, он рассчитывается каждый раз после изменений в JSON-документе конкурса. Также индикатор расчитывается один раз в сутки, если выполнены все условия для его расчета.


Поля для расчета
================

Для расчета индикатора используются следующие поля API модуля системы гос. закупок:

- ``data.parties.id``
- ``data.parties.roles``
- ``data.bids.details.tenderers.id``
- ``data.bids.details.status``
- ``data.tender.lots.id``

Для расчета используется аналитическая таблица:

- :ref:`tbl_oneBidderInTender`


Формула расчета
===============

1. Выбираем все лоты из конкурса ``data.tender.lots.id``.

2. Для каждого такого лота делаем следующее.

2.1. Выбираем предложения участников на лот: ``data.tender.lots.id`` входит в массив ``data.bids.details.relatedLots.id``. Из найденных берем только те предложения, у которых ``data.bids.details.status='active'``. 

2.2. Из найденных предложений выбираем идентификаторы участников - ``data.bids.details.tenderers.id``.

2.3. Если для лота найдено 2 и более участника ``data.bids.details.tenderers.id``, расчет для лота заканчивается.

2.4. Если найдено всего одно предложение, делаем следующее:

2.4.1. Выбираем идентификатор закупающей организации ``data.parties.id`` у которой ``data.parties.roles='buyer'``.

2.4.2. В таблице :ref:`tbl_oneBidderInTender` по идентификатору закупающей организации ищем количество лотов, на которые было подано всего одно предложение.

2.4.3. Если в таблице  :ref:`tbl_oneBidderInTender` для данной закупающей организации отсутствует запись, расчет для этого лота заканчивается.

2.4.4. Если в таблице  :ref:`tbl_oneBidderInTender` для данной закупающей организации количество лотов больше или равно 19, индикатор принимает значение ``1``, расчет индикатора заканчивается.

2.4.5. Если в таблице  :ref:`tbl_oneBidderInTender` для данной закупающей организации количество лотов меньше 19, расчет для лота заканчивается.

3. Если мы дошли до этого пункта, индикатор принимает значение ``0``.

Факторы, которые влияют на корректное срабатывание индикатора
=============================================================

Индикатор может срабатывать неправильнов случае, когда представитель закупающей организации плохо описал предмет закупки или не загрузил всю документацию на портал госзакупок.
